<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>BHML | Workspace Editor</title>
    <link rel="stylesheet" href="styles.css?v=1.1" />
    <!-- Preload Monaco Editor Loader -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
    <style>
      /* Inline critical CSS to prevent FOUC */
      body { margin: 0; overflow: hidden; background: #0b0d14; color: #e6e9f2; }
      .loading-screen { position: fixed; inset: 0; display: flex; align-items: center; justify-content: center; background: #0b0d14; z-index: 9999; }
    </style>
    <link rel="stylesheet" href="admin.css?v=2.0" />
  </head>
  <body>
    <!-- Login Overlay -->
    <div id="login-view" class="login-overlay">
      <div class="login-box">
        <h3 class="login-title">Admin Access</h3>
        <p class="login-hint">Enter your admin token to edit workspace files.</p>
        <form id="login-form">
          <input type="password" id="login-input" class="login-input" placeholder="Admin Token" autocomplete="current-password" />
          <button type="submit" class="admin-btn primary full-width">Unlock Editor</button>
        </form>
        <div id="login-message" class="login-message"></div>
      </div>
    </div>

    <!-- Main Workspace Interface -->
    <main id="editor-view" class="workspace hidden">
      <!-- Sidebar: File Explorer -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <div class="brand">BHML Dev</div>
          <button id="logout-btn" class="icon-btn" title="Logout">↩</button>
        </div>
        <div class="sidebar-content">
          <div class="path-tools">
            <div class="path-title">快速路径</div>
            <div class="path-quick">
              <button class="path-chip" data-path="assets/">assets/</button>
              <button class="path-chip" data-path="assets/logos/">assets/logos/</button>
              <button class="path-chip" data-path="data/">data/</button>
            </div>
            <div class="path-input-row">
              <input id="path-input" class="path-input" placeholder="输入路径/文件名（例如 assets/logo.png）" />
              <button id="open-path-btn" class="admin-btn small">打开</button>
            </div>
          <div class="path-actions">
            <button id="new-file-btn" class="admin-btn small">新建文件</button>
            <button id="upload-btn" class="admin-btn small">上传</button>
          </div>
          <div id="drop-zone" class="drop-zone">拖拽文件到此处上传</div>
            <input type="file" id="file-input" class="hidden" />
          </div>
          <div class="path-title">文件列表</div>
          <div id="file-list" class="file-list"></div>
        </div>
        <div class="sidebar-footer">
           <a href="index.html" target="_blank" class="preview-link">Open Site ↗</a>
        </div>
      </aside>

      <!-- Main: Code Editor -->
      <section class="main-area">
        <header class="editor-bar">
          <div class="tab-area">
            <span id="current-filename" class="tab-filename">No file selected</span>
            <span id="unsaved-indicator" class="unsaved-dot hidden">●</span>
          </div>
          <div class="actions-area">
            <span id="status-msg" class="status-msg"></span>
            <button id="save-btn" class="admin-btn primary small" disabled>Save (Ctrl+S)</button>
          </div>
        </header>
        <div id="monaco-container" class="monaco-container">
          <div class="empty-state">Select a file to start editing</div>
          <div id="image-preview-container" class="image-preview-container hidden">
            <img id="image-preview" src="" alt="Preview" />
          </div>
        </div>
      </section>
    </main>

    <script src="admin.js?v=2.0"></script>
  </body>
</html>
